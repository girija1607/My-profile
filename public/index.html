<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Me-API Playground</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f4f4f9; color: #333; max-width: 800px; margin: 2rem auto; padding: 1rem; }
    h1, h2 { color: #444; border-bottom: 2px solid #eee; padding-bottom: 10px; }
    .card { background-color: #fff; padding: 1.5rem; border-radius: 8px; margin-top: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    input { padding: 8px; margin-right: 5px; border: 1px solid #ddd; border-radius: 4px; }
    button { padding: 8px 12px; cursor: pointer; border: none; background-color: #007bff; color: white; border-radius: 4px; }
    button:hover { background-color: #0056b3; }
    .skills-container { display: flex; flex-wrap: wrap; gap: 8px; }
    .skill-tag { background-color: #e7f3ff; color: #0056b3; padding: 5px 10px; border-radius: 15px; font-size: 0.9em; }
    .links-container a { margin-right: 15px; color: #007bff; text-decoration: none; }
    .links-container a:hover { text-decoration: underline; }
    hr { border: 0; height: 1px; background-color: #eee; margin: 1.5rem 0; }
  </style>
</head>
<body>

  <h1>Me-API Playground</h1>
  <div id="profile-info" class="card">Loading profile...</div>

  <h2>Skills</h2>
  <div id="skills-list" class="card skills-container"></div>

  <h2>Education</h2>
  <div id="education-list" class="card"></div>

  <h2>Work Experience</h2>
  <div id="work-experience" class="card"></div>

  <h2>Links</h2>
  <div id="links-list" class="card links-container"></div>

  <h2>Search Projects by Skill</h2>
  <div class="card">
    <form id="search-form">
      <input type="text" id="skill-input" placeholder="e.g., Node, React" />
      <button type="submit">Search</button>
    </form>
  </div>
  
  <h2>Projects</h2>
  <div id="projects-list" class="card">Loading projects...</div>

  <script>
    const API_URL = 'https://my-profile-girija1607.vercel.app'; // MAKE SURE THIS IS YOUR CORRECT VERCEL URL

    async function fetchProfile() {
      try {
        const response = await fetch(`${API_URL}/profile`);
        if (!response.ok) throw new Error('Network response was not ok');
        const data = await response.json();
        
        // --- ALL THE RENDERING LOGIC IS NOW HERE ---

        // Display name and email
        document.getElementById('profile-info').innerHTML = `<h2>${data.name}</h2><p>${data.email}</p>`;
        
        // Display Skills
        const skillsList = document.getElementById('skills-list');
        if (data.skills && data.skills.length > 0) {
          skillsList.innerHTML = data.skills.map(skill => `<span class="skill-tag">${skill}</span>`).join('');
        }

        // Display Education
        const educationList = document.getElementById('education-list');
        if (data.education && data.education.length > 0) {
          educationList.innerHTML = data.education.map(edu => `
            <div>
              <h3>${edu.degree}</h3>
              <p>${edu.university} (${edu.year})</p>
            </div>
          `).join('<hr>');
        }

        // Display Work Experience
        const workExperienceList = document.getElementById('work-experience');
        if (data.workExperience && data.workExperience.length > 0) {
          workExperienceList.innerHTML = data.workExperience.map(job => `
            <div>
              <h3>${job.position}</h3>
              <p>${job.description}</p>
            </div>
          `).join('<hr>');
        } else {
          workExperienceList.innerHTML = '<p>No work experience listed.</p>';
        }

        // Display Links
        const linksList = document.getElementById('links-list');
        if (data.links) {
          linksList.innerHTML = Object.entries(data.links).map(([key, value]) => 
            `<a href="${value}" target="_blank" rel="noopener noreferrer">${key.charAt(0).toUpperCase() + key.slice(1)}</a>`
          ).join('');
        }

      } catch (error) {
        console.error('Failed to fetch profile:', error);
        document.getElementById('profile-info').innerHTML = '<p style="color: red;">Failed to load profile data.</p>';
      }
    }

    async function fetchProjects(skill = '') {
      try {
        let url = `${API_URL}/projects`;
        if (skill) {
          url += `?skill=${encodeURIComponent(skill)}`;
        }
        const response = await fetch(url);
        if (!response.ok) throw new Error('Network response was not ok');
        const projects = await response.json();
        
        const projectsList = document.getElementById('projects-list');
        if (projects.length === 0) {
          projectsList.innerHTML = '<p>No projects found.</p>';
          return;
        }
        
        projectsList.innerHTML = projects.map(p => `
          <div>
            <h3>${p.title}</h3>
            <p>${p.description}</p>
            <a href="${p.links.github}" target="_blank" rel="noopener noreferrer">GitHub</a>
          </div>
        `).join('<hr>');
      } catch (error) {
        console.error('Failed to fetch projects:', error);
        document.getElementById('projects-list').innerHTML = '<p style="color: red;">Failed to load projects.</p>';
      }
    }

    document.getElementById('search-form').addEventListener('submit', (event) => {
      event.preventDefault();
      const skill = document.getElementById('skill-input').value;
      fetchProjects(skill);
    });

    // Initial data load when the page opens
    fetchProfile();
    fetchProjects();
  </script>
</body>
</html>